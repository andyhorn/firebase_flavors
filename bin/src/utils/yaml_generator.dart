/// Utility class for generating YAML configuration file content.
class YamlGenerator {
  /// Generates the YAML configuration file content.
  static String generateContent({
    required String baseBundleId,
    required String appName,
    required List<String> flavors,
    required Map<String, String> flavorSuffixes,
    String? iosTarget,
  }) {
    final buffer = StringBuffer();

    buffer.writeln(
      '# Firebase flavor configuration generated by firebase_flavor_tool init',
    );
    buffer.writeln('# Review and edit as needed.');
    buffer.writeln('');
    buffer.writeln('appName: $appName');
    buffer.writeln('baseBundleId: $baseBundleId');
    buffer.writeln('');
    buffer.writeln('android:');
    buffer.writeln('  srcBase: android/app/src');
    buffer.writeln('');
    buffer.writeln('ios:');
    buffer.writeln('  xcodeprojPath: ios/${iosTarget ?? 'Runner'}.xcodeproj');
    buffer.writeln('  target: ${iosTarget ?? 'Runner'}');
    buffer.writeln('  configBase: ios/${iosTarget ?? 'Runner'}/Config');
    buffer.writeln('');
    buffer.writeln('flavors:');

    for (final flavor in flavors) {
      // Use detected suffix if available, otherwise infer from flavor name
      String suffix;
      if (flavorSuffixes.containsKey(flavor)) {
        suffix = flavorSuffixes[flavor]!;
      } else {
        final isProdLike =
            flavor.toLowerCase() == 'prod' ||
            flavor.toLowerCase() == 'production';
        suffix = isProdLike ? '' : flavor;
      }

      final optionsOut = 'lib/firebase_options_$flavor.dart';
      final androidSrcDir = flavor;
      final iosConfigDir = flavor;

      buffer.writeln('  $flavor:');
      buffer.writeln(
        '    firebaseProjectId: your-firebase-project-id-for-$flavor',
      );
      buffer.writeln('    androidPackageSuffix: $suffix');
      buffer.writeln('    dartOptionsOut: $optionsOut');
      buffer.writeln('    androidSrcDir: $androidSrcDir');
      buffer.writeln('    iosConfigDir: $iosConfigDir');
      buffer.writeln('    # Optional: override iOS bundle ID for this flavor.');
      buffer.writeln('    # iosBundleId: com.example.app.$flavor');
      buffer.writeln('');
    }

    return buffer.toString();
  }
}
